<!doctype html>
 <html class="no-js" lang="en">
 <head>
    <meta charset="utf-8"/>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Reaction test D.3</title>
    <!-- Compressed CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.3.1/css/foundation.min.css"
          integrity="sha256-itWEYdFWzZPBG78bJOOiQIn06QCgN/F0wMDcC4nOhxY=" crossorigin="anonymous"/>
    <link rel="stylesheet" href="app.css">
    <style>
       #circle {
          position: relative;
          top: 50%;
          -webkit-transform: translateY(-50%);
          -ms-transform: translateY(-50%);
          transform: translateY(-50%);
          background-color: red;
          border: 1px solid black;
          margin-left: auto;
          margin-right: auto;
    }</style>
 
    <style>
       #box {
          position: relative;
          top: 50%;
          -webkit-transform: translateY(-50%);
          -ms-transform: translateY(-50%);
          transform: translateY(-50%);
          background-color: green;
          border: 1px solid black;
          margin-right: auto;
          margin-left: auto;
       }</style>
 
 </head>
	<body>
		<script type="text/javascript">
			var experimentActive = false;
			var testActive = false;
			var times = new Array();
			var lastTimeAction;
			var counter = 0;
			var truecounter = 0;
			var falsecounter = 0;
			var ergebnis = false;
			var errorcounter = 0;
			
			var truelist = [
				"Germany",
				"Ukraine",
				"South Korea",
				"Netherlands",
				"Poland",
				"Ireland",
				"Tunisia",
				"Turkey",
				"Austria",
				"Luxemburg",
				"Spain",
				"Brazil",
				"Italy",
				"India",
				"Venezuela",
				"Nigeria",
				"Canada",
				"Japan",
				"China",
				"Marocco",
                "Greece",
			];
			
			var listFalse = [
				"Berlin",
				"Habana",
                "Beijing",
				"Tokyo",
				"Amsterdam",
				"Paris",
				"Madrid",
				"Stuttgart",
				"York",
				"Seattle",
				"Odessa",
				"Cologne",
				"Chicago",
				"Prague",
				"Kyiv",
				"Hamburg",
				"London",
				"Edinburgh",
				"Dublin",
                "Brazilia",
                "Antananarivo",
			];
			

			function startExperiment() {
				experimentActive = true;
				counter = 0;
				truecounter = 0;
				falsecounter = 0;
				ergebnis = false;
				errorcounter = 0;
				times = [];
				
				document.getElementById("time").innerHTML = "";
				document.getElementById("count").innerHTML = "";
				document.getElementById("mean").innerHTML = "";
				document.getElementById("sd").innerHTML = "";
				document.getElementById("errorcounter").innerHTML = "";

				document.getElementById("instruction").innerHTML = "Press 't' if you see a land, and 'f' if you see a city";
				
				startTest();
			}

			function startTest() {
				Random = Math.random();
				
				if (Random < 0.5) {
					ergebnis = true;
				} else {
					ergebnis = false;
				}
				
				if ((ergebnis && truecounter >= 21) || (!ergebnis && falsecounter >= 21)) {
					ergebnis = !ergebnis;
				}
				
				if (ergebnis) {
					isTrue();
				} else {
					isFalse();
				}
				
				
			}
			
			function isTrue() {
				testActive = true;
				Random = parseInt(Math.random() * truelist.length);
				document.getElementById("ausgabe").innerHTML = truelist[Random];
				truecounter++;
				lastTimeAction = new Date().getTime();
			}
			
			function isFalse() {
				testActive = true;
				Random = parseInt(Math.random() * falselist.length);
				document.getElementById("ausgabe").innerHTML = falselist[Random];
				falsecounter++;
				lastTimeAction = new Date().getTime();
			}

			function stopTest() {
				
				var currTime = new Date().getTime();
				var deltaTime = currTime - lastTimeAction;
				
				times.push(deltaTime);
				
				document.getElementById("time").innerHTML = deltaTime + "ms";
				testActive = false;
				count++;
				
				if (count >= 50) {
					stopExperiment();
				} else {
					startTest();
				}
			}

			function stopExperiment() {
				testActive = false;
				document.getElementById("ausgabe").innerHTML = "";
				
				var meanDeltaTime = 0.0;
				for (var i = 0; i < times.length; ++i) {
					meanDeltaTime += times[i];
				}
				meanDeltaTime = Math.round(meanDeltaTime / times.length);
				var standardDerivation = 0.0;
				for (var i = 0; i < times.length; ++i) {
					var diff = (times[i] - meanDeltaTime);
					standardDerivation += diff * diff;
				}
				
				standardDerivation = Math.round(Math.sqrt(standardDerivation / times.length));
				document.getElementById("count").innerHTML = "Count: " + times.length;
				document.getElementById("mean").innerHTML = "Mean: " + meanDeltaTime + "ms";
				document.getElementById("sd").innerHTML = "SD: " + standardDerivation + "ms";
				document.getElementById("errorcounter").innerHTML = "Errors: " + errorcounter;

				
				document.getElementById("instruction").innerHTML = "Press SPACE to start!";
				experimentActive = false;
			}

			document.onkeydown = onKey;
			function onKey(e) {
				if (e == null) {
					e = window.event;
				}
				switch (e.which || e.charCode || e.keyCode) {
					case 32:
						// space
						if (!experimentActive) {
							startExperiment();
						}
						break;
					case 84:
						// t
						if (experimentActive && !ergebnis) {
							errorcounter++;
						}
						stopTest();
						break;
					case 70:
						// f
						if (experimentActive && ergebnis) {
							errorcounter++;
						}
						stopTest();
						break;
				}
			}
		</script>
		<h1>
		<p id="ausgabe">
		</p></h1>
		
		<h1 id="instruction">Press SPACE to start!</h1>
		<p>
		<p id="time"></p>
		
		<p id="count"></p>
		<p id="mean"></p>
		<p id="sd"></p>
		<p id="error"></p>
	</body>
</html>
